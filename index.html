<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="cache-control" content="max-age=0">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">
  <meta http-equiv="pragma" content="no-cache">
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
  
  <title>Laima's Compass</title>

  <link href="/node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

  <script src="/node_modules/angular/angular.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>

<body ng-app="sampleApp">

  <div ng-controller="MasterController" class="container-fluid">

    <h2 class="sub-header">{{event.Character}}</h2>

    <div class="table-responsive">
      <table class="table table-striped">
        <thead>
          <tr>
            <th colspan=3>{{event.MapData.EngName}}</th>
          </tr>
          <tr>
            <th>Mob</th>
            <th>Kills</th>
            <th>Required</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat='(k,v) in event.Data'>
            <td>{{v.Data.Journal}}</td>
            <td>{{v.Kills}}</td>
            <td>{{v.ReqKills}}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <pre>{{event | json}}</pre>
  </div>
</body>

<script>
  var app = angular.module('sampleApp', [])
.controller('MasterController', function ($scope) {
  
  $scope.event = "leo";
  
  var socket = io();
  
 socket.on('data:maps', function(data){
   console.log('data:maps');
   
   $scope.maps = data;
   $scope.$apply();
  });
  
 socket.on('data:mobs', function(data){
   console.log('data:mobs');
   $scope.mobs = data;
   $scope.$apply();
  });
  
 socket.on('data:event', function(data){
   console.log('data:event');
   $scope.event = data;
   $scope.$apply();
  });
 
});

</script>

</html>